{% extends "base.html" %}

{% block heading %}
{% endblock %}

{% block content %}
<h1 style="width: 100%; text-align: center; display: inline-block; margin-top: 7%;">Big Five Personality Traits Assessment</h1>
<div style="margin: auto; width: 65%; height: 300px; border: 1px solid black; border-radius: 10px; background-color: rgb(118, 171, 231);">
    <div class="tab">
        <button style="font-size: 20px; font-weight: bold;" class="tablinks" onclick="open_trait(event, '{{traits_list[0]}}')" id="defaultOpen">{{traits_list[0]}}</button>
        {% for i in range(1, traits_list|length) %}
            <button style="font-size: 20px; font-weight: bold;" class="tablinks" onclick="open_trait(event, '{{traits_list[i]}}')">{{traits_list[i]}}</button>
        {% endfor %}
    </div>
    {% for i in range(0, traits_list|length) %}
        <div id="{{traits_list[i]}}" class="tabcontent">
            <table style="border-collapse: separate; border-spacing: 0.3em; width: 90%;">
            {% for j in range(0, big_five_traits_dict[traits_list[i]]|length) %}
                <tr>
                    <td style="font-size: 18px;">{{j+1}}.</td>
                    <td>
                        <label style="font-size: 18px;">{{big_five_traits_dict[traits_list[i]][j]}}</label>
                    </td>
                    <td>
                    <select id="{{i}}_{{j}}" style="font-size: 18px;">
                        <option value="">Select a value</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                    </td>
                </tr>
            {% endfor %}
            </table>
        </div>
    {% endfor %}
    <br>
    <button onclick="return check_parameters()" style="margin-left: 35%; width: 20%; height: 30px; border-radius: 5px; background-color: rgb(0, 255, 0); font-size: 18px; font-weight: bold;">Submit</button>
</div>
{% endblock %}

{% block script %}
<script>
    function open_trait(event, trait_name) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(trait_name).style.display = "block";
        event.currentTarget.className += " active";
    }
    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
</script>
<script>
    function check_parameters(){
        if (document.getElementById("0_0").value == "" || document.getElementById("0_1").value == "" || document.getElementById("0_2").value == "" || document.getElementById("0_3").value == "" || document.getElementById("0_4").value == ""){
            document.getElementById("error_modal").style.display= "block";
            document.getElementById("error_modal_text").innerText= "Please select all values for Openness trait.";
            return false;
        }
        else if (document.getElementById("1_0").value == "" || document.getElementById("1_1").value == "" || document.getElementById("1_2").value == "" || document.getElementById("1_3").value == "" || document.getElementById("1_4").value == ""){
            document.getElementById("error_modal").style.display= "block";
            document.getElementById("error_modal_text").innerText= "Please select all values for Conscientiousness trait.";
            return false;
        }
        else if (document.getElementById("2_0").value == "" || document.getElementById("2_1").value == "" || document.getElementById("2_2").value == "" || document.getElementById("2_3").value == "" || document.getElementById("2_4").value == ""){
            document.getElementById("error_modal").style.display= "block";
            document.getElementById("error_modal_text").innerText= "Please select all values for Extraversion trait.";
            return false;
        }
        else if (document.getElementById("3_0").value == "" || document.getElementById("3_1").value == "" || document.getElementById("3_2").value == "" || document.getElementById("3_3").value == "" || document.getElementById("3_4").value == ""){
            document.getElementById("error_modal").style.display= "block";
            document.getElementById("error_modal_text").innerText= "Please select all values for Agreeableness trait.";
            return false;
        }
        else if (document.getElementById("4_0").value == "" || document.getElementById("4_1").value == "" || document.getElementById("4_2").value == "" || document.getElementById("4_3").value == "" || document.getElementById("4_4").value == ""){
            document.getElementById("error_modal").style.display= "block";
            document.getElementById("error_modal_text").innerText= "Please select all values for Neuroticism trait.";
            return false;
        }
        else{
            var array = [];
            for (var i = 0; i < 5; i++){
                for (var j = 0; j < 5; j++){
                    array.push(document.getElementById(`${i}_${j}`).value);
                }
            }
            window.location.href= "/save_responses/" + array;
        }
    }
</script>
{% endblock %}